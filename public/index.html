<!doctype html>
<html>
	<head>
		<title>GoblinDB + Socket.IO</title>
	</head>
	<body>
		
		<h1>GoblinDB Socket interface ^^</h1>

		<p>This is an example for Real Time Goblin Interface. It is just a real time counter, in honor to josherif.</p>

		<h2 id="count"></h2>

		<button id="sum">+1</button>
		<button id="less">-1</button>

		<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>

		<script src="js/goblin-socket.js"></script>

		<script type="text/javascript">
			/* -- Implementation -- */

			// Initialize GoblinDB
			var gdb = new Goblin();

			// Counter variable
			var counter = 0;

			// Get the database value of counter
			gdb.get('counter', function(data) {

				// Update the local counter
				counter = data;

				// And print the value
				printCounter();
			});

			// Listen database changes. On change:
			gdb.on('change', function(data) {

				// Update the local counter
				counter = data.value.counter;
				
				// And print the value
				printCounter();
			});
			

			// Listen button clicks, and call the add and less functions
			document.getElementById('sum').addEventListener('click', add);
			document.getElementById('less').addEventListener('click', less);


			// Print on screen the value of counter variable
			function printCounter() {
				document.getElementById('count').innerHTML = counter;	
			}


			// Send +1 to the database
			function add() {
				var newCounter = counter + 1;
				gdb.set({'counter': newCounter});
			}

			// Send -1 to the database
			function less() {
				var newCounter = counter + 1;
				gdb.set({'counter': newCounter});
			}

		</script>

	</body>
</html>